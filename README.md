# Low Power Machine Learning
Neural Networks/Brain Computer Interface example
(Low power machine learning with microcontroller)

My Neural Network/Brain Computer Interface example: This is the code I used for my master thesis which was to build a Two Channel Low Power EEG Brain Computer Interface which tries to predict the left/right hand movement imagination via motor cortex activity.

Feature Extraction/Classification was designed and trained in a memory free environment using Wavelets in Matlab. Once the method was finalized two band pass filters were designed to implement very close feature extration/classification in memory strained low power environment -in this case the Texas Instruments MSP430FG4618 microcontroller board -which could be used as a real low power brain computer interface. Results are displayed on the LCD of the experimenter board.

Main.c -> Complete Embedded C code listing of the project Uses band pass filters and MLP Feedforward BackPropagation Neural Network.

//***************************************************************************** // MSP430FG4618 - Two Channel Low power EEG Mu & Beta Rhythm Classification // (Texas Instruments MSP430FG461x/F20xx Experimenter's Board) // main.c (requires TI freeware 16*16>32 multiply mul.s43 assembly code) // // Description; Uses analog board and INA333 instrumentation amplifiers to detect // the brainwaves, after amplification & anti-aliasing filter and ADC, the code // extracts mu and Beta Rhtym features of two channels using // FIR band passs filters and classifies the motor imagery, right or left using // A MLP backpropagation neural network, displays the result on LCD. // Multiplication is implemented in assembly for FIR band pass filters // to extract sub frequency band features. //
// Operation: After Power on Reset, code inits the peripherals, main clock freq, // ADC, LCD registers and digital I/O ports. Writes 'Hello' to LCD registers and // enters low power mode 3 (CPU Off / 32 KHz ACLK On, 1.3 ÂµA) waiting for interrupts. // ADC uses TimerA triggering, +1.5V internal, -1.5V external references which // are the supply ranges of instrumentation and operational amplifiers in the same time. // CPU operates with 3V battery, so with a voltage divider, supply voltage and // reference values are generated. // When Button 1 is pressed, Port1 Interrupt wakes up the CPU an in the Port1 // Interrupt Service Routine Basic timer is initialized to give about 1 second delay // While displaying 'Ready' on LCD. After servicing the ISR the cpu automatically // enters back to LPM3 awakened by Basic timer interrupt after 1 second. 'Start' // is written to the LCD in the Basic timer interrupt Routine and TimerA is initialized // to start the ADC sampling with 128Hz sampling rate. After 448 samples are // stored (448 comes from memory limitations and it means 3.5 seconds sampling) // TimerA is stopped and stored values are filtered. 4 features are calculated // and scaled for neural network input. After neural net classification results // are displayed on LCD, then 'Hello' is displayed again and system enters back // to the low power mode 3 waiting for button interrupt. // // Notes: // -- Source generates about 40KB program code and uses about 5KB RAM, which // are not available in many of the members of MSP430 family excluding MSP430X // architecture and new MSP430x5xxx series. // -- Hardware multiplier and DMA gives DSP like capabilities to FG4618.But // many of the MSP430 devices lack MPY or DMA can be very slow on multiplication. // -- Different feature extraction bands can be applied by only chaning the // filter coefficients. ScopeFIR program can be used to design and scale // filter coefficients. // -- Neural Network performance can be tested in a memory free environment. // Neural network architecture can be easily customized by changing hidden neuron // and learning rate variables. // // Ozan Gunaydin // Bogazici University // Istanbul; ozangunaydin@gmail.com // 2010 //***************************************************************************** //***************************************************************************** //*****************************************************************************


